---
title: 中间人攻击
comments: true
toc: true
top: 
declare: true
copyright: true
tags:
  - RSA
  - 中间人攻击
date: 2019-01-30 16:44:02
---

* 一次正常RSA 加解密流程：用户发起连接请求，服务器发送公钥给客户端，客户端使用服务端公钥加密相关信息并发送给服务端。服务端使用私钥解密，获取信息进行验证及处理。
<!--more-->
![rsa_authentication](https://i.loli.net/2019/01/28/5c4f031052614.gif)
* 中间人攻击：中间人截取用户验证请求，发送中间人公钥给客户端。客户端利用假公钥加密的信息就会被中间人解密。中间人拿到客户端信息再去和服务端交互。服务端返回的数据会先经过中间人再到用户，这样用户的数据就得不到安全保障。因为中间人可以修改用户数据。
![man_in_the_middle_attack](https://i.loli.net/2019/01/28/5c4f03107259c.gif)

==总结一下就是：中间人对客户端是伪装服务端，对服务端伪装客户端==

#### 简单防护
* 防护 1：客户端将正常验证请求到的服务端公钥进行保存。之后发起请求时将服务端返回的公钥和本地进行匹配。匹配一致才交互。但是也有弊端，如果服务器确实更换了公钥，那么客户端将连接不上，此时需要删除客户端之前保存的公钥，这也要求服务端一定要及时通知客户端。

* 防护 2：上面的方法不能保证客户端拿到的公钥就是正确的。这时服务端可以将公钥进行一次 hash 并公布。因为数据的 hash 值是唯一的。因此客户端将拿到的公钥也进行 hash 一次，和服务器公布的 hash 比对，一致才交互。

* ··· 其他的防护再补充，想起就补充 !^_^!


<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=34383004&auto=1&height=66"></iframe>